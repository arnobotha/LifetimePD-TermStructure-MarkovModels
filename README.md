# LifetimePD-TermStructure-Multistate
[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.14899815.svg)](https://doi.org/10.5281/zenodo.14899815)

The lifetime behaviour of loans is notoriously difficult to model, which can compromise a bank's financial reserves against future losses, if modelled poorly. Therefore, we present a data-driven comparative study amongst three techniques in modelling a series of default risk estimates over the lifetime of each loan, i.e., its term-structure. The behaviour of loans can be described using a nonstationary and time-dependent semi-Markov model, though we model its elements using a multistate regression-based approach. As such, the transition probabilities are explicitly modelled as a function of a rich set of input variables, including macroeconomic and loan-level inputs. Our modelling techniques are deliberately chosen in ascending order of complexity: 1) a Markov chain; 2) beta regression; and 3) multinomial logistic regression. Using residential mortgage data, our results show that each successive model outperforms the previous, likely as a result of greater sophistication. This finding required devising a novel suite of simple model diagnostics, which can itself be reused in assessing sampling representativeness and the performance of other modelling techniques. These contributions surely advance the current practice within banking when conducting multistate modelling. Consequently, we believe that the estimation of loss reserves will be more timeous and accurate under IFRS 9.

## Structure
This R-codebase can be run sequentially using the file numbering itself as a structure. **Delinquency measures** are algorithmically defined in **DelinqM.R** as data-driven functions, which may be valuable to the practitioner outside of the study's current scope. These delinquency measures were formulated and empirically tested in [Botha22](https://www.researchgate.net/publication/358329458_The_loss_optimization_of_loan_recovery_decision_times_using_forecast_cashflows), as part of a loss optimisation exercise of recovery decision times, as implemented in the corresponding [R-codebase](https://github.com/arnobotha/The-loss-optimisation-of-loan-recovery-decision-times-using-forecast-cash-flows). A simulation study from [Botha2021](https://www.researchgate.net/publication/350169758_Simulation-based_optimisation_of_the_timing_of_loan_recovery_across_different_portfolios) also demonstrated these delinquency measures at length, with its corresponding [R-codebase](https://github.com/arnobotha/Simulation-based-optimisation-of-the-timing-of-loan-recovery-across-different-portfolios). Similarly, the **TruEnd-procedure** from [Botha2024](https://www.researchgate.net/publication/380214432_The_TruEnd-procedure_Treating_trailing_zero-valued_balances_in_credit_data) and its corresponding [R-codebase](https://github.com/arnobotha/TruEnd-Procedure)  is implemented in the **TruEnd.R** script, which includes a small variety of functions related to running the TruEnd-procedure practically.

## Data
This R-codebase assumes that monthly loan performance data is available. Naturally, the data itself can't be made publically available given its sensitive nature, as well as various data privacy laws, particularly the _Protection of Personal Information (POPI)_ Act of 2013 in South Africa. However, the structure and type of data that is required for reproducing this study, is sufficiently described in the commentary within the scripts. This should enable the practitioner to extract and prepare data accordingly. Moreover, this codebase assumes South African macroeconomic data is available, as sourced and collated by internal staff of the bank in question.

## Copyright
All code and scripts are hereby released under an [MIT](https://opensource.org/licenses/MIT) license. Similarly, all graphs produced by relevant scripts as well as those published here, are hereby released under a Creative Commons Attribution ([CC-BY 4.0](https://creativecommons.org/licenses/by/4.0/)) licence.
